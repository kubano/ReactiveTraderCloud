#! /bin/bash

build=$1
release="release"

set -eo pipefail

scream() {
    echo -e "\e[31merror on $1\033[0m"
    exit 1
}

root_directory="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )/../.."

source ${root_directory}/deploy/touched.sh

for server in ${RUN_LIST[@]}
do
    server_run_command="${root_directory}/deploy/docker/run/${server}/run"
    ${server_run_command} $build $release || scream $server
    sleep 2
done
